<!doctype html>
<html>
	<head>
		<meta charset="utf-8">
		<meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">

		<title>Dr. Upal is In - Healthcheck your site!</title>

		<link rel="stylesheet" href="css/reveal.css">
		<link rel="stylesheet" href="css/theme/prescription.css">

		<!-- Theme used for syntax highlighting of code -->
		<link rel="stylesheet" href="lib/css/zenburn.css">

		<!-- Printing and PDF exports -->
		<script>
			var link = document.createElement( 'link' );
			link.rel = 'stylesheet';
			link.type = 'text/css';
			link.href = window.location.search.match( /print-pdf/gi ) ? 'css/print/pdf.css' : 'css/print/paper.css';
			document.getElementsByTagName( 'head' )[0].appendChild( link );
		</script>
	</head>
	<body>
		<div class="reveal">
			<div class="slides">
				<section>
          <h1>Dr . Upal Is In:</h1>
          <h2>Healthcheck your site!</h2>
          <p>&nbsp;</p>
          <small>use &larr;&uarr;&darr;&rarr; or &lt;SPACE&gt;</small>
        </section>

        <section>
          <h2>"Where's the links?"</h2>
          <p><a href="https://socketwench.github.io/healthcheck-your-site/#/">socketwench.github.io/healthcheck-your-site</a></p>
        </section>

        <section>
          <section data-transition="none" data-background-transition="none" data-background="images/socketwench1.png" data-background-size="contain">
            &nbsp;
          </section>
          <section data-transition="none" data-background-transition="none" data-background="images/socketwench2.png" data-background-size="contain">
            &nbsp;
          </section>
          <section data-transition="none" data-background-transition="none" data-background="images/socketwench3.png" data-background-size="contain">
            &nbsp;
          </section>
					<section data-transition="none" data-background-transition="none" data-background="images/socketwench4.png" data-background-size="contain">
            &nbsp;
          </section>
					<section data-transition="none" data-background-transition="none" data-background="images/socketwench5.png" data-background-size="contain">
            &nbsp;
          </section>
          <section data-background="images/teamten7.jpeg" class="teamten7">
            <img src="images/TEN7-logo.png" />
            <p>We create and care for<br />Drupal-powered websites.</p>
            <p><a href="https://twitter.com/TEN7">@TEN7</a><br /><a href="mailto:hi@ten7.com">hi@ten7.com</a></p>
          </section>
        </section>

        <section>
          <section>
            <h1>"But my site is fine!"</h1>
          </section>
          <!--
            This doesn't really sell the idea of an audit all that well.
            Most site stakeholders either don't think their site needs
            an audit, or think they are too invasive and embarassing.
            They'd rather wait until something actually breaks.
          -->
          <section>
            <h2>Every site is healthy</h2>
            <p class="fragment">...until it isn't.</p>
          </section>
          <section data-transition="none">
            <img src="images/butMySiteIsFine1.png" />
          </section>
          <section data-transition="none">
            <img src="images/butMySiteIsFine2.png" />
          </section>
          <section data-transition="none">
            <img src="images/butMySiteIsFine3.png" />
          </section>
          <section data-transition="none">
            <img src="images/butMySiteIsFine4.png" />
          </section>
          <section data-transition="none">
            <img src="images/butMySiteIsFine5.png" />
          </section>
          <section data-transition="none">
            <img src="images/butMySiteIsFine6.png" />
          </section>
          <section data-transition="none">
            <img src="images/butMySiteIsFine7.png" />
          </section>
          <section data-transition="none">
            <img src="images/butMySiteIsFine8.png" />
          </section>
          <section data-transition="none">
            <img src="images/butMySiteIsFine9.png" />
          </section>
          <section>
            <h2>Reasons to audit</h2>
            <p class="fragment">Errors, breakage, malicious content</p>
            <p class="fragment">Poor performance</p>
            <p class="fragment">"It's your site now."</p>
          </section>
          <section data-transition="none">
            <img src="images/iHaveABadFeeling1.png" />
          </section>
          <section data-transition="none">
            <img src="images/iHaveABadFeeling2.png" />
          </section>
          <section data-transition="none">
            <img src="images/iHaveABadFeeling3.png" />
          </section>
          <section>
            <h2>A feeling isn't an audit</h2>
            <p class="fragment">...but a feeling is a sign you need one.</p>
          </section>
          <section  data-transition="none" data-background-transition="none" data-background="images/didWeBuildItRight1.png" data-background-size="contain">
            &nbsp;
          </section>
          <section  data-transition="none" data-background-transition="none" data-background="images/didWeBuildItRight2.png" data-background-size="contain">
            &nbsp;
          </section>
          <section  data-transition="none" data-background-transition="none" data-background="images/didWeBuildItRight3.png" data-background-size="contain">
            <h2>Smoke testing</h2>
            <p class="fragment">Check if you're on the right path</p>
            <p class="fragment">Can be difficult to check in-house</p>
            <p>&nbsp;</p>
          </section>
          <!--
            What benefit does an audit provide if bad things are found?
          -->
          <section>
            <h2>Your experience is not universal</h2>
            <p class="fragment">Anonymous survey, external agency</p>
          </section>
          <section>
            <h2>It's better to know and plan</h2>
            <p class="fragment">...than just hope for the best.</p>
          </section>
        </section>

        <section>
          <section data-transition="none">
            <img src="images/whatCanWeCheckNow1.png" />
          </section>
          <section data-transition="none">
            <img src="images/whatCanWeCheckNow2.png" />
          </section>
          <section data-transition="none">
            <img src="images/whatCanWeCheckNow3.png" />
          </section>
          <section data-transition="none">
            <img src="images/whatCanWeCheckNow4.png" />
          </section>
          <section>
            <h1>Checking the basics</h1>
          </section>
          <section>
            <h2>Checking for updates</h2>
            <p class="fragment">Yes, really.</p>
            <p class="fragment">The most basic, important thing you can do!</p>
          </section>
          <section>
            <h2>Using the Update Report</h2>
            <p class="fragment">Admin &gt; Reports &gt; Available Updates</p>
          </section>
          <section>
            <h2>I can't find it!</h2>
            <p class="fragment">Provided by the <strong>Update Manager</strong> module</p>
            <p class="fragment">May be disabled on production sites</p>
          </section>
          <section>
            <h2>Enabling Update Manager</h2>
            <p class="fragment">Admin &gt; Extend</p>
          </section>
          <section data-transition="none">
            <img src="images/dontPanic1.png" />
          </section>
          <section data-transition="none">
            <img src="images/dontPanic2.png" />
          </section>
          <section data-transition="none" data-background-transition="none" data-background="images/redAlert.jpg">
            <img src="images/dontPanic3.png" />
          </section>
          <section data-transition="none" data-background-transition="none" data-background="images/redAlert.jpg">
            <img src="images/dontPanic4.png" />
          </section>
          <section>
            <h2>Don't panic!</h2>
            <p class="fragment">Your site won't be a "sea of green"</p>
          </section>
          <section data-transition="none" data-background-transition="none" data-background="images/actionNotUpdate1.png" data-background-size="contain">
            <h2>Look for Red</h2>
            <p class="fragment">Security updates, unsupported modules</p>
            <p class="fragment">Take Action ASAP!</p>
          </section>
          <section data-transition="none" data-background-transition="none" data-background="images/actionNotUpdate2.png" data-background-size="contain">
            <h2>Look for Red</h2>
            <p>Security updates, unsupported modules</p>
            <p>Take Action ASAP!</p>
          </section>
          <section>
            <h2>Out-of-date Modules</h2>
            <p class="fragment">Some sites break if updated!</p>
            <p class="fragment"><strong>Always</strong> ask your team first!</p>
          </section>
          <section data-transition="none" data-background-transition="none" data-background="images/whatElseCanWeCheck.png" data-background-size="contain">
            &nbsp;
          </section>
          <section>
            <h2>Status Report</h2>
            <p class="fragment">Overview of your site</p>
            <p class="fragment">Admin &gt; Reports &gt; Status</p>
          </section>
          <section>
            <h2>Look for red</h2>
            <p class="fragment">Misconfigurations</p>
            <p class="fragment">Updates required</p>
            <p class="fragment">Down connections to external services</p>
          </section>
          <section>
            <h2>Caching</h2>
            <p class="fragment">Admin &gt; Configuration &gt; Development &gt; Performance</p>
          </section>
          <section>
            <h2>Caching best practices</h2>
            <p class="fragment">CSS and JS files Aggregated</p>
            <p class="fragment">Page cache maximum age set*</p>
            <small class="fragment">* Most sites</small>
          </section>
          <section>
            <h2>Check your log</h2>
            <p class="fragment">Don't look for specific errors...</p>
            <p class="fragment">...look for frequency of severe errors!</p>
          </section>
          <section>
            <h2>Using the DB Log</h2>
            <p class="fragment">dblog enabled for most sites</p>
            <p class="fragment">Admin &gt; Reports &gt; Recent Log Messages</p>
          </section>
          <section data-transition="none">
            <img src="images/automatingChecks1.png" />
          </section>
          <section data-transition="none">
            <img src="images/automatingChecks2.png" />
          </section>
          <section data-transition="none">
            <img src="images/automatingChecks3.png" />
          </section>
          <section data-transition="none">
            <img src="images/automatingChecks4.png" />
          </section>
          <section data-transition="none">
            <img src="images/automatingChecks5.png" />
          </section>
          <section data-transition="none">
            <img src="images/automatingChecks6.png" />
          </section>
          <section data-transition="none">
            <img src="images/automatingChecks7.png" />
          </section>
          <section data-transition="none">
            <img src="images/automatingChecks8.png" />
          </section>
          <section data-transition="none">
            <img src="images/automatingChecks9.png" />
          </section>
        </section>

        <section>
          <section>
            <h1>Automating Checks</h1>
          </section>
          <section>
            <h2>Site Audit module</h2>
            <p class="fragment">Gathers data, runs best practice checks</p>
            <p class="fragment"><a href="https://www.drupal.org/project/site_audit">drupal.org/project/site_audit</a></p>
          </section>
          <section>
            <h2>Requires drush</h2>
            <p class="fragment">Command Line tool for Drupal</p>
            <p class="fragment"><a href="http://docs.drush.org/en/master/install/">docs.drush.org/en/master/install</a></p>
          </section>
          <section>
            <h2>Installation for D7</h2>
            <p class="fragment"><code>drush en -y site_audit</code></p>
            <p class="fragment"><code>drush cc all</code></p>
          </section>
          <section>
            <h2>Installation for D8</h2>
            <p class="fragment"><code>composer require drupal/site_audit</code></p>
            <p class="fragment"><code>mkdir drush</code></p>
            <p class="fragment"><code>mv modules/contrib/site_audit drush/</code></p>
            <p class="fragment"><code>drush cr drush</code></p>
          </section>
          <!--
            COMIC
            Okay, that's installed,
            How do I run a report?
          -->
          <section>
            <pre><code class="shell">cd path/to/your/site</code></pre>
            <pre class="fragment"><code class="shell">drush aa
  --html
  --bootstrap
  --detail
  --skip=insights
  > path/to/report.html</code></pre>
          </section>
          <section>
            <img src="images/site_audit_report_header.png" />
          </section>
          <section data-transition="none">
            <img src="images/howMuchNeedsRead1.png" />
          </section>
          <section data-transition="none">
            <img src="images/howMuchNeedsRead2.png" />
          </section>
          <section data-transition="none">
            <img src="images/howMuchNeedsRead3.png" />
          </section>
          <section data-transition="none">
            <img src="images/howMuchNeedsRead4.png" />
          </section>
          <section data-transition="none">
            <img src="images/howMuchNeedsRead5.png" />
          </section>
          <section data-transition="none">
            <img src="images/howMuchNeedsRead6.png" />
          </section>
          <section data-transition="none">
            <img src="images/howMuchNeedsRead7.png" />
          </section>
          <section data-transition="none">
            <img src="images/howMuchNeedsRead8.png" />
          </section>
          <section data-transition="none">
            <img src="images/howMuchNeedsRead9.png" />
          </section>
          <section data-transition="none">
            <img src="images/howMuchNeedsRead10.png" />
          </section>
          <section>
            <h2>Best Practice Checks</h2>
            <p class="fragment">Read them all!</p>
            <p class="fragment">Highest value checks in the whole report</p>
          </section>
          <section>
            <h2>services.yml warning</h2>
            <p class="fragment">Techincally correct, but...</p>
            <p class="fragment">...core's own services.yml is preferred.</p>
            <small class="fragment"><a href="https://www.drupal.org/project/drupal/issues/2547447">drupal.org/project/drupal/issues/2547447</a></small>
          </section>
          <section>
            <h2>Caching Settings</h2>
            <p class="fragment">Best performance value for small sites</p>
            <p class="fragment">Consider cache minimum lifetime carefully!</p>
          </section>
          <section>
            <h2>Status and Updates</h2>
            <p class="fragment">Same as Update Manager and Status Report</p>
            <p class="fragment">Replaces manual steps, no login needed!</p>
          </section>
          <section>
            <img src="images/whatElseCanSiteAuditDo.png" />
          </section>
          <section>
            <h2>Content checks</h2>
            <p class="fragment">More FYI than problem-finding</p>
            <p class="fragment">Does not replace a content audit</p>
          </section>
          <section>
            <h2>Technical stats</h2>
            <p class="fragment">File, code, DB sizes</p>
            <p class="fragment">Sometimes useful! Depends on your site.</p>
          </section>
          <section>
            <h2>PHP code analysis</h2>
            <p class="fragment">Code smells, copy-pasting, mess detection</p>
            <p class="fragment">Requires additional composer-installed utilites</p>
          </section>
          <section>
            <h2>Even more things</h2>
            <p class="fragment">Site Audit is extensible!</p>
            <p class="fragment">Reports differ slightly between D7 & D8</p>
          </section>
          <section data-transition="none">
            <img src="images/siteAuditAndDoneRight1.png" />
          </section>
          <section data-transition="none">
            <img src="images/siteAuditAndDoneRight2.png" />
          </section>
          <section data-transition="none">
            <img src="images/siteAuditAndDoneRight3.png" />
          </section>
          <section data-transition="none">
            <img src="images/siteAuditAndDoneRight4.png" />
          </section>
          <section data-transition="none">
            <img src="images/siteAuditAndDoneRight5.png" />
          </section>
        </section>

        <section>
          <section>
            <h1>Infrastructure checkups</h1>
          </section>
          <!--
            COMIC
            Still on fire, huh?
          -->
          <section>
            <h2>Where're you hosted?</h2>
            <p class="fragment">Shared hosting</p>
            <p class="fragment">Managed hosting (Pantheon, Acquia)</p>
            <p class="fragment">Self-managed (VPS, internal)</p>
          </section>
          <section>
            <h2>Still happy with it?</h2>
            <p class="fragment">What was your primary motive?</p>
            <p class="fragment">Is that still true?</p>
          </section>
          <!--
            COMIC
            I'm not a Linux master...
            Is there anything I can check?
          -->
          <section>
            <h2>Enough memory?</h2>
            <p class="fragment"><code>free</code> utility</p>
            <p class="fragment">Shows used, free, and available memory</p>
          </section>
          <section>
            <pre class="shell"><code>$ free -h</code></pre>
<pre class="shell fragment"><code>        total    used    free   shared  buff/cache   available
Mem:     15Gi   3.8Gi   4.1Gi    1.7Gi       7.7Gi         9Gi
Swap:    31Gi    77Mi   31Gi</code></pre>
            <small class="fragment">(Scroll right)</small>
          </section>
          <section>
            <h2>What about disk?</h2>
            <p class="fragment"><code>df</code> or "disk free" utility</p>
            <p class="fragment">Free space, not performance</p>
          </section>
          <section>
            <pre><code class="shell">$ df -h</code></pre>
<pre class="fragment"><code class="shell">Filesystem      Size  Used Avail Use% Mounted on
dev             7.8G     0  7.8G   0% /dev
run             7.8G  1.9M  7.8G   1% /run
/dev/nvme0n1p3  434G  142G  270G  35% /
/dev/nvme0n1p1  599M   42M  558M   7% /boot</code></pre>
          </section>
          <section>
            <h2>Disk mounts</h2>
            <p class="fragment">Site shouldn't cross devices</p>
            <p class="fragment">Adds performance hit, deployment complexity</p>
          </section>
          <section>
            <h2>CPU load</h2>
            <p class="fragment"><code>top</code> utility</p>
            <p class="fragment">Look for <code>idle</code> or <code>id</code> percent</p>
          </section>
          <section>
            <pre><code>Mem: 12541644K used, 3767604K free, 1816292K shrd, 965248K buff, 6908000K cache
CPU:   1% usr   0% sys   0% nic  96% idle   0% io   0% irq   0% sirq
Load average: 0.70 0.87 0.92 4/1173 264
  PID  PPID USER     STAT   VSZ %VSZ CPU %CPU COMMAND
   29     1 apache   S     373m   2%   1   0% /usr/sbin/httpd -D FOREGROUND -f /
   30     1 apache   S     368m   2%   3   0% /usr/sbin/httpd -D FOREGROUND -f /
   33     1 apache   S     368m   2%   2   0% /usr/sbin/httpd -D FOREGROUND -f /
   32     1 apache   S     368m   2%   0   0% /usr/sbin/httpd -D FOREGROUND -f /
  139     1 apache   S     368m   2%   2   0% /usr/sbin/httpd -D FOREGROUND -f /
    1     0 apache   S     368m   2%   0   0% /usr/sbin/httpd -D FOREGROUND -f /
   42     0 apache   S     6244   0%   1   0% /bin/bash
  263    42 apache   R     1532   0%   0   0% top</code></pre>
            <small class="fragment">(Press <code>q</code> to quit)</small>
          </section>
          <section data-transition="none" data-background-transition="none" data-background="images/sharedSelfHostedNeedsAudit1.png" data-background-size="contain">
            <h2>Managed Hosting</h2>
            <p class="fragment">Typically do not need auditing</p>
            <p class="fragment">Memory, disk, CPU typically auto-scaled</p>
          </section>
          <section data-transition="none" data-background-transition="none" data-background="images/sharedSelfHostedNeedsAudit2.png" data-background-size="contain">
            <h2>Managed Hosting</h2>
            <p>Typically do not need auditing</p>
            <p>Memory, disk, CPU typically auto-scaled</p>
          </section>
          <section>
            <h2>PHP Version</h2>
            <p class="fragment">D8 should always be on PHP 7!</p>
            <p class="fragment">For D7, try PHP 7, otherwise PHP 5.6</p>
          </section>
          <section>
            <h2>"Updating" PHP</h2>
            <p class="fragment">Actual 5.x to 7.x updates are rare</p>
            <p class="fragment">Better to move to new server/hosting</p>
          </section>
          <section>
            <h2>CLI vs. Web PHP</h2>
            <p class="fragment">PHP version (x.y) should always match</p>
            <p class="fragment">Configuration may differ, but only minor</p>
          </section>
          <section data-transition="none" data-background-transition="none" data-background="images/whatAboutCliPhp1.png" data-background-size="contain">
            <h2>Checking Web PHP</h2>
            <p class="fragment">Best done through the web UI</p>
            <p class="fragment">Admin > Reports > Status</p>
          </section>
          <section data-transition="none" data-background-transition="none" data-background="images/whatAboutCliPhp2.png" data-background-size="contain">
            <h2>Checking Web PHP</h2>
            <p>Best done through the web UI</p>
            <p>Admin > Reports > Status</p>
          </section>
          <section>
            <pre><code>$ php --version</code></pre>
<pre class="fragment"><code>PHP 5.6.33 (cli) (built: Feb  7 2018 15:35:50)
Copyright (c) 1997-2016 The PHP Group
Zend Engine v2.6.0, Copyright (c) 1998-2016 Zend Technologies
with Zend OPcache v7.0.6-dev, Copyright (c) 1999-2016, by Zend Technologies
with Xdebug v2.5.0, Copyright (c) 2002-2016, by Derick Rethans</code></pre>
            </section>
          <section>
            <h2>Database server</h2>
            <p class="fragment">Same or separate, <em>latency</em> is the key!</p>
            <p class="fragment">Common problem for shared hosts</p>
          </section>
          <section>
            <h2>Measuring latency</h2>
            <p class="fragment"><code>ping</code> utility</p>
            <p class="fragment">From web server, <code>ping</code> DB server</p>
          </section>
          <section>
            <h2>Ping measures the network</h2>
            <p class="fragment">not DB responsivness!</p>
          </section>
          <section>
            <pre><code>$ ping 192.168.1.10</code></pre>
            <pre class="fragment"><code>PING 192.168.1.10 (192.168.1.10) 56(84) bytes of data.
64 bytes from 192.168.1.10: icmp_seq=1 ttl=63 time=0.378 ms
64 bytes from 192.168.1.10: icmp_seq=2 ttl=63 time=0.473 ms</code></pre>
            <small class="fragment">(Use Ctrl-C to exit)</small>
          </section>
          <section>
            <h2>As your site grows...</h2>
            <p class="fragment">...you can outgrow your hosting.</p>
          </section>
        </section>

        <section>
          <section data-transition="none">
            <img src="images/dontHackCore1.png" />
          </section>
          <section data-transition="none">
            <img src="images/dontHackCore2.png" />
          </section>
          <section data-transition="none">
            <img src="images/dontHackCore3.png" />
          </section>
          <section data-transition="none">
            <img src="images/dontHackCore4.png" />
          </section>
          <section>
            <h1>Auditing modded code</h1>
          </section>
          <section>
            <h2>Mods aren't "hacks"</h2>
            <p class="fragment">Not malicious!</p>
            <p class="fragment">Intentional modification of core & contrib code</p>
          </section>
          <section>
            <h2>Why mod?</h2>
            <p class="fragment">Expediency, lack of knowledge</p>
            <p class="fragment">Unaware of "offical" patching process</p>
          </section>
          <section>
            <h2>Patch, don't mod</h2>
            <p class="fragment">Post issue & patch if broad benefit...</p>
            <p class="fragment">...or at least keep <code>*.patch</code> file in repo.</p>
          </section>
          <section>
            <h2>Right way to patch</h2>
            <p class="fragment">Use <a href="https://github.com/cweagans/composer-patches">cweagans/composer-patches</a></p>
            <p class="fragment">Refer to the patch on D.O if posted</p>
          </section>
          <section data-transition="none">
            <img src="images/dontKnowIfModded1.png" />
          </section>
          <section data-transition="none">
            <img src="images/dontKnowIfModded2.png" />
          </section>
          <section data-transition="none">
            <img src="images/dontKnowIfModded3.png" />
          </section>
          <section data-transition="none">
            <img src="images/dontKnowIfModded4.png" />
          </section>
          <section data-transition="none">
            <img src="images/dontKnowIfModded5.png" />
          </section>
          <section data-transition="none">
            <img src="images/dontKnowIfModded6.png" />
          </section>
          <section>
            <h2><a href="https://www.drupal.org/project/hacked">Hacked! module</a></h2>
            <p class="fragment">Compares installed core & contrib against D.O</p>
            <p class="fragment">Version aware</p>
          </section>
          <section>
            <h2>When to use</h2>
            <p class="fragment">You use ftp (not git or CI) to deploy</p>
            <p class="fragment">You haven't updated in ages</p>
            <p class="fragment">You suspect a breach</p>
          </section>
          <section>
            <h2>Non-security reasons</h2>
            <p class="fragment">Whenever you adopt a site</p>
            <p class="fragment">Bad practice core or module modification</p>
          </section>
          <section>
            <h2>Installation</h2>
            <p class="fragment"><code class="shell">composer require drupal/hacked</code></p>
            <p class="fragment"><code class="shell">drush en -y hacked</code></p>
          </section>
          <section>
            <h2>Run against Live</h2>
            <p class="fragment">Results can differ with your local</p>
            <p class="fragment">Module can be removed after use</p>
          </section>
          <section>
            <h2>Running the report</h2>
            <p class="fragment">Admin &gt; Reports &gt; Hacked</p>
          </section>
          <section>
            <h2>False Positives</h2>
            <p class="fragment">Minor changes can flag a module</p>
            <p class="fragment">Missing READMEs, line-endings, best-practice changes</p>
          </section>
          <section>
            <img src="images/docker.test_admin_reports_hacked.png" />
          </section>
          <section>
            <h2>Getting detailed results</h2>
            <p class="fragment">Install the <a href="https://www.drupal.org/project/diff">diff</a> module</p>
            <p class="fragment">Displays individual line changes</p>
          </section>
          <section>
            <img src="images/docker.test_admin_reports_hacked_flag_diff1.png" />
          </section>
          <section>
            <img src="images/docker.test_admin_reports_hacked_flag_diff2.png" />
          </section>
          <section>
            <img src="images/docker.test_admin_reports_hacked_flag_diff3.png" />
          </section>
          <section>
            <h2>Going Legit</h2>
            <p class="fragment">Extract patch from changes</p>
            <p class="fragment">Post to D.O, add to repo</p>
          </section>
          <section>
            <h2>Modding isn't wrong</h2>
            <p class="fragment">...but it needs to be done right</p>
          </section>
        </section>

        <section>
          <section data-transition="none">
            <img src="images/haveIBeenHacked1.png" />
          </section>
          <section data-transition="none">
            <img src="images/haveIBeenHacked2.png" />
          </section>
          <section data-transition="none">
            <img src="images/haveIBeenHacked3.png" />
          </section>
          <section data-transition="none">
            <img src="images/haveIBeenHacked4.png" />
          </section>
          <section data-transition="none">
            <img src="images/haveIBeenHacked5.png" />
          </section>
          <section data-transition="none">
            <img src="images/haveIBeenHacked6.png" />
          </section>
          <section data-transition="none">
            <img src="images/haveIBeenHacked7.png" />
          </section>
          <section data-transition="none">
            <img src="images/haveIBeenHacked8.png" />
          </section>
          <section>
            <h1>Hacks and Recovery</h1>
          </section>
          <section>
            <h2>Signatures</h2>
            <p class="fragment">Clues that imply a hack</p>
          </section>
          <section>
            <h2>eval() + base64_decode()</h2>
            <p class="fragment">Common way to unpack, execute exploit code</p>
          </section>
          <section>
            <h2>Scanning code for Hacks</h2>
            <p class="fragment">Hacked! report, <code>grep</code> utility</p>
            <p class="fragment">Look for duplicate files & modules</p>
          </section>
          <section>
            <h2>Checking logs</h2>
            <p class="fragment">Look for PHP errors, odd 404s</p>
            <p class="fragment">May be subtle or buried</p>
          </section>
          <section>
            <h2>"Wildlife"</h2>
            <p class="fragment">The 'net isn't a clean place!</p>
            <p class="fragment">Frequent drive-by attacks are <strong>common</strong></p>
          </section>
          <section>
            <h2>2018 Drupalgeddons</h2>
            <p class="fragment">Can leave no signature!</p>
            <p class="fragment">Not patched on patch day? Assume you're hacked.</p>
          </section>
          <section data-transition="none">
            <img src="images/youveBeenHacked1.png" />
          </section>
          <section data-transition="none">
            <img src="images/youveBeenHacked2.png" />
          </section>
          <section data-transition="none">
            <img src="images/youveBeenHacked3.png" />
          </section>
          <section data-transition="none" data-background-transition="none" data-background="images/fire.gif">
            <img src="images/youveBeenHacked4.png" />
          </section>
          <section data-transition="none" data-background-transition="none" data-background="images/fire.gif">
            <img src="images/youveBeenHacked5.png" />
          </section>
          <section data-transition="none" data-background-transition="none" data-background="images/nowThatWereCalm1.png" data-background-size="contain">
            <h2>DON'T PANIC</h2>
            <p class="fragment">Breathe.</p>
          </section>
          <section data-transition="none" data-background-transition="none" data-background="images/nowThatWereCalm2.png" data-background-size="contain">
            <h2>DON'T PANIC</h2>
            <p>Breathe.</p>
          </section>
          <section>
            <h2>Take the site offline</h2>
            <p class="fragment">Better to be offline than compromised</p>
            <p class="fragment">User privacy, partner exposure, brand damage</p>
          </section>
          <section>
            <h2>Backup the hacked site</h2>
            <p class="fragment">You need a working copy to examine</p>
            <p class="fragment">Place it in an air-gapped system</p>
          </section>
          <section>
            <h2>When were you hacked?</h2>
            <p class="fragment">Requires some sleuthing</p>
            <p class="fragment">Tie to missed module or core security release</p>
          </section>
          <section>
            <h2>Find a clean backup</h2>
            <p class="fragment">DB, code, and files from before the hack</p>
            <p class="fragment">Be sure it isn't compromised!</p>
          </section>
          <section>
            <h2>Update the clean backup</h2>
            <p class="fragment">Apply all security updates and patches</p>
            <p class="fragment">Copy content over manually</p>
          </section>
          <section>
            <h2>Back it up again</h2>
            <p class="fragment">Avoid rebuilding a second time</p>
            <p class="fragment">Site may still be exposed in other ways</p>
          </section>
          <section>
            <h2>No Backup?</h2>
            <p class="fragment">Clean up what you can</p>
            <p class="fragment">Accept risk of follow-up hacks</p>
          </section>
          <section data-transition="none">
            <img src="images/serverCompromised1.png" />
          </section>
          <section data-transition="none">
            <img src="images/serverCompromised2.png" />
          </section>
          <section data-transition="none">
            <img src="images/serverCompromised3.png" />
          </section>
          <section data-transition="none" data-background-transition="none" data-background="images/itHurts1.png" data-background-size="contain">
            <h2>Throw away and rebuild</h2>
            <p class="fragment">Really. <span class="fragment">Assume it's comprimised.</span></p>
            <p class="fragment">Invalidate all passwords and start over</p>
            <p>&nbsp;</p>
          </section>
          <section data-transition="none" data-background-transition="none" data-background="images/itHurts2.png" data-background-size="contain">
            <h2>Throw away and rebuild</h2>
            <p>Really. <span>Assume it's comprimised.</span></p>
            <p>Invalidate all passwords and start over</p>
            <p>&nbsp;</p>
          </section>
          <section>
            <h2>You will be hacked</h2>
            <p class="fragment">...but you can be prepared.</p>
          </section>
        </section>

        <section>
          <section data-transition="none">
            <img src="images/postHackedNowWhat1.png" />
          </section>
          <section data-transition="none">
            <img src="images/postHackedNowWhat2.png" />
          </section>
          <section data-transition="none">
            <img src="images/postHackedNowWhat3.png" />
          </section>
          <section data-transition="none">
            <img src="images/postHackedNowWhat4.png" />
          </section>
          <section>
            <h1>Remediation</h1>
          </section>
          <section>
            <h2>Recover from hacks first</h2>
            <p class="fragment">Restore to a clean state, then...</p>
            <p class="fragment">...apply all security updates.</p>
          </section>
          <section data-transition="none" data-background-transition="none" data-background="images/theyreSmallChanges1.png" data-background-size="contain">
            <h2>Then, fix all the easy stuff</h2>
            <p class="fragment">Disable bad-practice modules</p>
            <p class="fragment">Best practice config changes</p>
          </section>
          <section data-transition="none" data-background-transition="none" data-background="images/theyreSmallChanges2.png" data-background-size="contain">
            <h2>Then, fix all the easy stuff</h2>
            <p>Disable bad-practice modules</p>
            <p>Best practice config changes</p>
          </section>
          <section data-transition="none" data-background-transition="none" data-background="images/theyreSmallChanges3.png" data-background-size="contain">
            <h2>Then, fix all the easy stuff</h2>
            <p>Disable bad-practice modules</p>
            <p>Best practice config changes</p>
          </section>
          <section>
            <h2>Statistics module</h2>
            <p class="fragment">Does a DB write on each request!</p>
            <p class="fragment">Rarely needed, as other analyics are used</p>
          </section>
          <section>
            <h2>PHP Module</h2>
            <p class="fragment">Executes PHP code in content</p>
            <p class="fragment">Instant security vulnerability!</p>
          </section>
          <section>
            <h2>Uninstalling PHP module</h2>
            <p class="fragment">Check text-formats, use of <a href="https://www.drupal.org/project/views_php">Views PHP</a> first!</p>
            <p class="fragment">Test for breakage, then uninstall.</p>
          </section>
          <section>
            <h2>Lots of revisions</h2>
            <p class="fragment">Slows down content retrival</p>
            <p class="fragment">Revisions past the last 3 are low value</p>
          </section>
          <section>
            <h2>Opt-in Revisions</h2>
            <p class="fragment">Disable automatic revisions by type</p>
            <p class="fragment">Doesn't clean out existing, old revisions</p>
          </section>
          <section>
            <h2><a href="https://www.drupal.org/project/node_revision_delete">Node Revision Delete</a></h2>
            <p class="fragment">Limits # of revisions by type</p>
            <p class="fragment">Cleans out old revisions</p>
          </section>
          <section>
            <h2>Watchdog too big</h2>
            <p class="fragment">dblog module can be slow</p>
            <p class="fragment">Ease of use might be worth it</p>
          </section>
          <section>
            <h2>Clearing Watchdog</h2>
            <p class="fragment"><code>drush watchdog-delete all</code></p>
            <p class="fragment">Delete can also be targeted, see <a href="https://drushcommands.com/drush-8x/watchdog/watchdog-delete/">Drush Docs</a></p>
          </section>
          <section>
            <h2>Syslog module</h2>
            <p class="fragment">Write to web server syslog instead of DB</p>
            <p class="fragment">Faster, requires more Ops coordination</p>
          </section>
          <section>
            <h2>Duplicate modules</h2>
            <p class="fragment">Confusing, causes missed updates</p>
            <p class="fragment">Can be sign of a hack</p>
          </section>
          <section>
            <h2>Which module to remove?</h2>
            <p class="fragment">There's what you think...</p>
            <p class="fragment">...and what Drupal thinks.</p>
          </section>
          <section>
            <h2>Finding the active module</h2>
            <p class="fragment"><code>drush pmi <em>module_name</em></code></p>
            <p class="fragment">Look for <code>Path</code></p>
          </section>
          <section>
            <pre><code>$ drush pmi dblog</code></pre>
            <pre class="fragment"><code> Extension        :  dblog
 Project          :  Unknown
 Type             :  module
 Title            :  Database Logging
...
 Path             :  core/modules/dblog
...
 Permissions      :  none
 Configure        :  system.logging_settings</code></pre>
          </section>
          <section>
            <h2>No pmi in Drush 9</h2>
            <pre class="fragment"><code>drush ev
  "return \Drupal::moduleHandler()
    ->getModule('module_name')
    ->getPath();"</code></pre>
            <small class="fragment">(All on one line)</small>
          </section>
          <section>
            <h2>De-duping modules</h2>
            <p class="fragment">Remove, <code>drush cr && drush updb</code></p>
            <p class="fragment">Test locally first!</p>
          </section>
          <section data-transition="none">
            <img src="images/messyDocroot1.png" />
          </section>
          <section data-transition="none">
            <img src="images/messyDocroot2.png" />
          </section>
          <section data-transition="none">
            <img src="images/messyDocroot3.png" />
          </section>
          <section data-transition="none">
            <img src="images/messyDocroot4.png" />
          </section>
          <section data-transition="none">
            <img src="images/messyDocroot5.png" />
          </section>
          <section>
            <h2>Messy docroot</h2>
            <p class="fragment">Can create automation, composer problems</p>
            <p class="fragment">Move to files directory, use .htaccess redirect</p>
          </section>
          <section>
            <h2>Caching & Aggregation</h2>
            <p class="fragment">Enable for all sites!</p>
            <p class="fragment">Consider minimum lifetime carefully</p>
          </section>
          <section data-transition="none">
            <img src="images/thatsTheEasyStuff1.png" />
          </section>
          <section data-transition="none">
            <img src="images/thatsTheEasyStuff2.png" />
          </section>
          <section data-transition="none">
            <img src="images/thatsTheEasyStuff3.png" />
          </section>
          <section data-transition="none">
            <img src="images/thatsTheEasyStuff4.png" />
          </section>
          <section>
            <h2>Audit != Performance Analysis</h2>
            <p class="fragment">Different tools, approaches</p>
            <p class="fragment">Time and brain intensive process</p>
          </section>
          <section>
            <h2>Where are you slow?</h2>
            <p class="fragment">Certain pages?</p>
            <p class="fragment">Logged in or out?</p>
            <p class="fragment">Everywhere!?</p>
          </section>
          <section>
            <h2>Web profiler</h2>
            <p class="fragment">Part of <a href="https://www.drupal.org/project/devel">devel</a> module</p>
            <p class="fragment">Times major parts of processing</p>
          </section>
          <section>
            <img src="images/webprofiler.png" />
          </section>
          <section>
            <img src="images/webprofiler_page.png" />
          </section>
          <section>
            <h2>Slow DB vs. PHP</h2>
            <p class="fragment">Code can fixed</p>
            <p class="fragment">Slow DBs require hosting change</p>
          </section>
          <section>
            <h2>Finding PHP Bottlenecks</h2>
            <p class="fragment">XDebug Profiler</h2>
            <p class="fragment">Complex set up, should not be run on live</p>
            <p class="fragment">Included out of the box in <a href="https://github.com/ten7/flight-deck">Flight Deck</a></p>
          </section>
          <section>
            <h2>Performance is a process</h2>
            <p class="fragment">Not a fix.</p>
          </section>
        </section>

        <section>
          <section data-transition="none">
            <img src="images/mistakesWereMade1.png" />
          </section>
          <section data-transition="none">
            <img src="images/mistakesWereMade2.png" />
          </section>
          <section data-transition="none">
            <img src="images/mistakesWereMade3.png" />
          </section>
          <section data-transition="none">
            <img src="images/mistakesWereMade4.png" />
          </section>
          <section data-transition="none">
            <img src="images/mistakesWereMade5.png" />
          </section>
          <section data-transition="none">
            <img src="images/mistakesWereMade6.png" />
          </section>
          <section data-transition="none">
            <img src="images/mistakesWereMade7.png" />
          </section>
          <section data-transition="none">
            <img src="images/mistakesWereMade8.png" />
          </section>
          <section data-transition="none">
            <img src="images/mistakesWereMade9.png" />
          </section>
          <section>
            <h1>Mistakes were made</h1>
          </section>
          <section>
            <h2>It's not broken...</h2>
            <p class="fragment">...but it's not working <span class="fragment">(well)</span> either.</p>
          </section>
          <section data-transition="none" data-background-transition="none" data-background="images/yourSiteNeedsToChange1.png" data-background-size="contain">
            <h2>Why does this happen?</h2>
            <p class="fragment">Inexperience, bad assumptions, changing priorities</p>
          </section>
          <section data-transition="none" data-background-transition="none" data-background="images/yourSiteNeedsToChange2.png" data-background-size="contain">
            <h2>Why does this happen?</h2>
            <p>Inexperience, bad assumptions, changing priorities</p>
          </section>
          <section data-transition="none" data-background-transition="none" data-background="images/yourSiteNeedsToChange3.png" data-background-size="contain">
            &nbsp;
          </section>
          <section>
            <h2>Too few content types</h2>
            <p class="fragment">Articles and Basic Pages everywhere</p>
            <p class="fragment">Tons of fields, not all used</p>
          </section>
          <section>
            <h2>Too many content types</h2>
            <p class="fragment">Differentiation only in name, not use or data</p>
            <p class="fragment">Press Release vs. Blog Post vs. News</p>
          </section>
          <section data-transition="none">
            <img src="images/contentProblems1.png" />
          </section>
          <section data-transition="none">
            <img src="images/contentProblems2.png" />
          </section>
          <section>
            <h2>Do a content audit</h2>
            <p class="fragment">Inventory of all types and content</p>
          </section>
          <section>
            <h2>Rethink Content Stategy</h2>
            <p class="fragment">Drop old, irrelvent content</p>
            <p class="fragment">Use card sorting to rediscover groupings</p>
          </section>
          <section>
            <h2>Merge, split types</h2>
            <p class="fragment">Can be done manually or using Migrate</p>
            <p class="fragment">Per-node tasks via Views Bulk Operations</p>
          </section>
          <section>
            <h2>Reorganize</h2>
            <p class="fragment">Update menus, build new sections</p>
            <p class="fragment">Use Pathauto and Redirect to keep SEO</p>
          </section>
          <section data-transition="none">
            <img src="images/needALayoutManager1.png" />
          </section>
          <section data-transition="none">
            <img src="images/needALayoutManager2.png" />
          </section>
          <section data-transition="none">
            <img src="images/needALayoutManager3.png" />
          </section>
          <section data-transition="none">
            <img src="images/needALayoutManager4.png" />
          </section>
          <section>
            <h2>Layout is not content</h2>
            <p class="fragment">Gives site messy, inconsistent feel</p>
          </section>
          <section>
            <h2>Layout managers</h2>
            <p class="fragment">Separates content from layout</p>
            <p class="fragment">
              <a href="https://www.drupal.org/project/paragraphs">Paragraphs</a>,
              <a href="https://www.drupal.org/project/panels">Panels</a>,
              <a href="https://www.drupal.org/project/block_visibility_groups">Block Visibilty Groups</a>
            </p>
          </section>
          <section data-transition="none">
            <img src="images/deeperThanContent.png" />
          </section>
          <section>
            <h2>Custom implementions</h2>
            <p class="fragment">Contrib available, but wasn't used</p>
            <p class="fragment">Misses security reviews, bug fixes</p>
          </section>
          <section>
            <h2>Overuse, abuse of a feature</h2>
            <p class="fragment">Causes gradual performance loss</p>
            <p class="fragment">Often unaware, or unintentional</p>
          </section>
          <section>
            <h2>Can it be changed?</h2>
            <p class="fragment">Isolated features easier to replace</p>
            <p class="fragment">Accept or deprecate essential features</p>
          </section>
          <section>
            <h2>Look to the long term</h2>
            <p class="fragment">Fast fixes bring brief benfit</p>
          </section>
        </section>

        <section>
          <section>
            <h1>When to ask for help</h1>
          </section>
          <section>
            <h2>Time for a new site?</h2>
            <p class="fragment">Current site code unsupported</p>
            <p class="fragment">Cheaper, easier to rebuild than fix</p>
            <p class="fragment">"It's time for it."</p>
          </section>
          <section>
            <h2>Rebuilds easier on staff</h2>
            <p class="fragment">"Rip the bandage off" approach</p>
            <p class="fragment">Enforce best practices from the start</p>
          </section>
          <section>
            <h2>Hosting change</h2>
            <p class="fragment">Create new live environment</p>
            <p class="fragment">Update domain IP at launch</p>
          </section>
          <section>
            <h2>Don't go alone</h2>
            <p class="fragment">Bring in external help on a rebuild</p>
            <p class="fragment">Outside perspective, broader experiences</p>
          </section>
          <section>
            <h2>Do they audit?</h2>
            <p class="fragment">Good "get to know each other" exercise</p>
            <p class="fragment">Informs better estimating</p>
          </section>
        </section>

        <section>
          <section>
            <h2>Special thanks</h2>
            <p class="fragment">Twin Cities Drupal</p>
            <p class="fragment"><a href="https://twitter.com/timplunkett">@timplunkett</a>, <a href="https://twitter.com/wizonesolutions">@wizonesolutions</a></p>
						<p class="fragment">TEN7</p>
            <p class="fragment"><a href="https://www.patreon.com/socketwench">patreon.com/socketwench</a></p>
          </section>

          <section>
            <h2>Sunday Sprints</h2>
            <p class="fragment">9:30-5, address in your program</p>
            <p class="fragment">Help from mentors all day!</p>
          </section>

          <section data-background-transition="none" data-background="images/thankYou.png" data-background-size="contain">
            <h1>Thank you!</h1>
            <p>socketwench.github.io/healthcheck-your-site</p>
            <p>&nbsp;</p>
          </section>
        </section>

			</div>
		</div>

		<script src="lib/js/head.min.js"></script>
		<script src="js/reveal.js"></script>

		<script>
			Reveal.initialize({
        history: true,
        controls: false,
        progress: true,
        center: true,
        width: 1024,
        height: 763,
        transition: 'slide',

				dependencies: [
					{ src: 'plugin/highlight/highlight.js' },
					{ src: 'plugin/notes/notes.js', async: true },
				]
			});
		</script>
	</body>
</html>
